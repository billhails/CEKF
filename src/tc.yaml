#
# CEKF - VM supporting amb
# Copyright (C) 2022-2024  Bill Hails
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
#

config:
    name: tc
    description: Structures to support type inference


cmp:
    extraArgs:
        map: HashTable
    bespokeImplementation:
    - TcVar

structs:
    TcEnv:
        data:
            table: TcTypeTable
            typeSigs: TcTypeSigTable
            next: TcEnv

    TcNg:
        data:
            table: TcTypeTable
            next: TcNg

    TcFunction:
        data:
            arg: TcType
            result: TcType

    TcPair:
        data:
            first: TcType
            second: TcType

    TcTypeSig:
        data:
            name: HashSymbol
            args: TcTypeSigArgs
            ns: int

    TcTypeSigArgs:
        data:
            type: TcType
            next: TcTypeSigArgs

    TcVar:
        data:
            name: HashSymbol
            id: int
            instance: TcType=NULL

hashes:
    TcTypeTable:
        data:
            entries: TcType

    TcTypeSigTable:
        data:
            entries: TcTypeSig

arrays:
    TcTypeArray:
        data:
            dimension: 1
            entries: TcType

    TcNamespaceArray:
        data:
            dimension: 1
            entries: TcType

unions:
    TcType:
        data:
            function: TcFunction
            pair: TcPair
            var: TcVar
            smallinteger: void_ptr
            biginteger: void_ptr
            character: void_ptr
            unknown: HashSymbol
            opaque: HashSymbol
            typeSig: TcTypeSig
            tuple: TcTypeArray
            namespaces: TcNamespaceArray
            env: TcEnv
            nsid: int

primitives: !include primitives.yaml
