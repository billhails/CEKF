// Over-application tests (enhanced diagnostics)

let
    link "ioutils.fn" as io;
    import io operator "$_";
    fun1 = fn (x, y) { fn (z) { x + y + z } };
    r1 = fun1(1, 2, 3);
    fun2 = fn (a, b) { fn (c) { fn(d) { a + b + c + d } } };
    r2 = fun2(1, 2, 3, 4);
    g = fn (x) { fn (y) { fn (z) { x + y + z } } };
    multAdd = fn (x, y) { fn (z) { x * y + z } };
    r3 = multAdd(2, 5, 3);
in
    print("typeof fun1: " @@ typeof fun1);
    print("result fun1(1,2,3): " @@ $r1);
    assert(r1 == 6);
    print("Test OA1 passed: direct lambda m=2, n=3 => 6");
    print("typeof fun2: " @@ typeof fun2);
    print("result fun2(1,2,3,4): " @@ $r2);
    assert(r2 == 10);
    print("Test OA2 passed: direct lambda m=2, n=4 => 10");
    print("typeof g: " @@ typeof g);
    assert(g(1, 2, 3) == 6);
    print("typeof multAdd: " @@ typeof multAdd);
    print("result multAdd(2,5,3): " @@ $r3);
    assert(r3 == 13);
    print("Test OA3 passed: mixed cases (sanity checks)");
