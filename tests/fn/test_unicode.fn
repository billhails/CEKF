let
    link "listutils.fn" as list;

    fn test_unicode_basic() {
        let
            Î£ = "abc\u03b1;\u03b2;\u03b3;";
            Î¨ = "abcÎ±Î²Î³";
            Î± = '\u03b1;';
            // dissapointing but correct: â™® is a symbol not a letter so Fâ™® is not a valid identifier
            // Fâ™® = "cool";
            alpha = 'Î±';
            Î± = '\u03b1;';
            smile = 'ğŸ˜€';
        in
            assert(list.length(Î£) == 6);
            assert(list.length(Î¨) == 6);
            assert(Î£ == Î¨);
            assert(Î± == 'Î±');
            assert(ord(Î±) == 945);
            assert(chr(945) == Î±);
            assert(chr(0x3b1) == Î±);
            assert("F\u266e;" == "Fâ™®");
            // ğŸ˜¥
            // assert(Fâ™® == "cool");
            assert(unicode_category(alpha) == GC_Ll);
            assert(ord(smile) == 0x1F600);
    }

    fn test_unicode_ascii() {
        // isalnum tests
        assert(isalnum('a'));
        assert(not isalnum('!'));
        // isalpha tests
        assert(isalpha('z'));
        assert(not isalpha('5'));
        // isascii tests
        assert(isascii('A'));
        assert(not isascii('ğŸ˜€'));
        // isblank tests
        assert(isblank(' '));
        assert(not isblank('x'));
        // isclose tests
        assert(isclose(')'));
        assert(not isclose('('));
        // iscntrl tests
        assert(iscntrl('\n'));
        assert(not iscntrl('a'));
        // isdigit tests
        assert(isdigit('7'));
        assert(not isdigit('a'));
        // isgraph tests
        assert(isgraph('!'));
        assert(not isgraph(' '));
        // islower tests
        assert(islower('g'));
        assert(not islower('G'));
        // isnumber tests
        assert(isnumber('3'));
        assert(not isnumber('x'));
        // isopen tests
        assert(isopen('('));
        assert(not isopen(')'));
        // isprint tests
        assert(isprint('q'));
        assert(not isprint('\u0001;'));
        // ispunct tests
        assert(ispunct('.'));
        assert(not ispunct('w'));
        // isspace tests
        assert(isspace(' '));
        assert(not isspace('m'));
        // issymbol tests
        assert(issymbol('$'));
        assert(not issymbol('e'));
        // isupper tests
        assert(isupper('Z'));
        assert(not isupper('z'));
        // isvalid tests
        assert(isvalid('a'));
        assert(isvalid('ğŸ˜€'));
        // isxdigit tests
        assert(isxdigit('F'));
        assert(not isxdigit('G'));
    }
    
    fn test_unicode_extended() {
        // Additional Unicode tests beyond ASCII
        // Greek letters
        assert(isalpha('Î±'));
        assert(isalpha('Î©'));
        assert(islower('Î±'));
        assert(isupper('Î©'));
        assert(not isdigit('Î±'));
        // Cyrillic letters
        assert(isalpha('Ğ¯'));
        assert(isalpha('Ğ¶'));
        assert(isupper('Ğ¯'));
        assert(islower('Ğ¶'));
        // Arabic digits
        assert(isdigit('Ù¥')); // Arabic-Indic digit five
        assert(isnumber('Ù¥'));
        assert(not isalpha('Ù¥'));
        // Chinese/Japanese characters
        assert(isalpha('ä¸­'));
        assert(not isdigit('ä¸­'));
        assert(not ispunct('ä¸­'));
        // Mathematical symbols
        assert(issymbol('âˆ‘')); // summation symbol
        assert(issymbol('âˆ')); // infinity
        assert(not isalpha('âˆ‘'));
        // Punctuation from other scripts
        assert(ispunct('ã€‚')); // CJK full stop
        assert(ispunct('ï¼›')); // CJK semicolon
        // Various brackets
        assert(isopen('ã€Œ')); // CJK opening bracket
        assert(isclose('ã€')); // CJK closing bracket
        assert(isopen('ã€Š'));
        assert(isclose('ã€‹'));
        // Currency symbols
        assert(issymbol('â‚¬'));
        assert(issymbol('Â¥'));
        assert(issymbol('Â£'));
        assert(not isalpha('â‚¬'));
        // Emoji tests
        assert(not isascii('ğŸ˜€'));
        assert(not isalpha('ğŸ˜€'));
        assert(not isdigit('ğŸ˜€'));
        assert(issymbol('ğŸ˜€'));
        // Roman numerals
        assert(isnumber('â…¦')); // Roman numeral seven
        assert(isnumber('â…·')); // small Roman numeral eight
        // Vulgar fractions
        assert(isnumber('Â½')); // fraction one half
        assert(isnumber('Â¾')); // fraction three quarters
        // Superscripts and subscripts
        assert(isnumber('Â²')); // superscript two
        assert(isnumber('â‚ƒ')); // subscript three
        // Spaces of various widths
        assert(isspace('\u00a0;')); // non-breaking space
        assert(isspace('\u3000;')); // ideographic space
        assert(isblank('\u00a0;'));
        // Control characters
        assert(iscntrl('\u001b;')); // escape character
        assert(not isprint('\u001b;'));
        // Combining characters
        assert(not isalpha('\u0301;')); // combining acute accent (mark, not letter)
    }
in
    test_unicode_basic();
    test_unicode_ascii();
    test_unicode_extended();
