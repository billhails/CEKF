let
    fn test_curry(n, f) {
        f(n)
    }

    fn add(a, b) {
        a + b
    }

    fn makeWriter() {
        switch(openmem()) {
            (success(fh)) {
                success(#(fputs(fh), fn() { fgets(fh) }));
            }
            (failure(err)) { failure(err) }
        }
    }

in
    assert(test_curry(2, add(3)) == 5);
    unsafe switch(makeWriter()) {
        (success(#(fp, fg))) {
            fp("Hello, ");
            fp("world!\n");
            assert(fg() == "Hello, world!\n");
        }
    }
