let
    link "ioutils.fn" as io;

    operator "$_" 14 io.to_string;
in
    assert(io.to_string(1234 + 5i) == "(1234+5i)");
    assert($(1/0) == "nan");
    assert($(1/0 + 1i) == "nan");
    assert($(1 + ((1/0) * 1i)) == "nan");

    assert($((1/0) / 2) == "nan");
    assert($(1 / (1/0)) == "nan");
    assert($((1/0) / (2/3)) == "nan");

    assert($(((1/0) / 2) + 1i) == "nan");
    assert($(1 + ((((1/0) / 2)) * 1i)) == "nan");
    assert($(((1/0) / (2/3)) + (((3/4) / (1/0)) * 1i)) == "nan")

    assert($((1/0) gcd 2) == "nan");
    assert($(2 gcd (1/0)) == "nan");
    assert($((1/0) lcm 2) == "nan");
    assert($(2 lcm (1/0)) == "nan");
    assert($(GCD(1/0, 2)) == "nan");
    assert($(LCM(1/0, 2)) == "nan");

    assert($((1.5 + 2i) gcd (0.5 + 1i)) == "nan");
    assert($((1.5 + 2i) lcm (0.5 + 1i)) == "nan");

    assert($((3/2) gcd (9/4)) == "3/4");
    assert($((3/2) lcm (9/4)) == "9/2");
    assert($(GCD(3/2, 9/4)) == "3/4");
    assert($(LCM(3/2, 9/4)) == "9/2");

    assert($((4 + 2i) gcd (6 + 3i)) == "(2+1i)");
    assert($((4 + 2i) lcm (6 + 3i)) == "(12+6i)");
    assert($(GCD(4 + 2i, 6 + 3i)) == "(2+1i)");
    assert($(LCM(4 + 2i, 6 + 3i)) == "(12+6i)");

    assert($((-3/2 + (-1/2)*1i) gcd (-3 + (-1)*1i)) == "(3/2+(1/2)i)");
    assert($((-3/2 + (-1/2)*1i) lcm (-3 + (-1)*1i)) == "(3+1i)");
    assert($(GCD(-3/2 + (-1/2)*1i, -3 + (-1)*1i)) == "(3/2+(1/2)i)");
    assert($(LCM(-3/2 + (-1/2)*1i, -3 + (-1)*1i)) == "(3+1i)");

    assert($(6/4) == "3/2");
